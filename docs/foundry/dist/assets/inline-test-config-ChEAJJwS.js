import{j as s}from"./index-D5UbER3f.js";import{u as r}from"./index-CZxYc6i7.js";const c=void 0;function i(n){const e={a:"a",code:"code",div:"div",h2:"h2",h3:"h3",p:"p",pre:"pre",span:"span",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...r(),...n.components};return s.jsxs(s.Fragment,{children:[s.jsxs(e.h2,{id:"in-line-test-configuration",children:["In-line test configuration",s.jsx(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#in-line-test-configuration",children:s.jsx(e.div,{"data-autolink-icon":!0})})]}),`
`,s.jsxs(e.p,{children:["Foundry users are enabled to specify overall test configurations, using a combination of ENV variables and config statements in the ",s.jsx(e.code,{children:"foundry.toml"}),". Checkout the ",s.jsx(e.a,{href:"./testing.md",children:s.jsx(e.code,{children:"Testing reference"})})," for a detailed description."]}),`
`,s.jsx(e.p,{children:"Despite this may work in the general case, some tests may need finer control over their configuration. For such reason Forge provides a way to specify per-test configs for invariant and fuzz testing scenarios."}),`
`,s.jsxs(e.p,{children:["Users can in-line test config statements directly in Solidity comments. This would affect the behavior of the ",s.jsx(e.code,{children:"forge test"})," command for a specific test instance, as illustrated in the example below."]}),`
`,s.jsx(s.Fragment,{children:s.jsx(e.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:s.jsxs(e.code,{children:[s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"contract"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" MyTest"}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:" is"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" Test"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.fuzz.runs = 100"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: ci.fuzz.runs = 500"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.fuzz.show-logs = true"})}),`
`,s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"  function"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#DCBDFB"},children:" test_SimpleFuzzTest"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"("}),s.jsx(e.span,{style:{color:"#005CC5","--shiki-dark":"#6CB6FF"},children:"uint256"}),s.jsx(e.span,{style:{color:"#E36209","--shiki-dark":"#F69D50"},children:" x"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:") "}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"public"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"    // --- snip ---"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  }"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"}"})})]})})}),`
`,s.jsxs(e.p,{children:["What we are asking here is to run our fuzzer ",s.jsx(e.code,{children:"100"})," and ",s.jsx(e.code,{children:"500"})," times for the ",s.jsx(e.code,{children:"default"})," and ",s.jsx(e.code,{children:"ci"})," profiles respectively. The interesting fact is that this would override any fuzz ",s.jsx(e.code,{children:"runs"})," setup existing at a global level. All other configs would be inherited from the global context, making this acting as a fallback for all possible configurations."]}),`
`,s.jsxs(e.h3,{id:"block-comments",children:["Block comments",s.jsx(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#block-comments",children:s.jsx(e.div,{"data-autolink-icon":!0})})]}),`
`,s.jsx(e.p,{children:"In-line test configurations can also be expressed in block comments, as illustrated in the example."}),`
`,s.jsx(s.Fragment,{children:s.jsx(e.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:s.jsxs(e.code,{children:[s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"contract"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" MyTest"}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:" is"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" Test"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /**"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"   * forge-config: default.fuzz.runs = 1024"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"   * forge-config: default.fuzz.max-test-rejects = 500"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"   * forge-config: default.fuzz.show-logs = true"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"   */"})}),`
`,s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"  function"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#DCBDFB"},children:" test_SimpleFuzzTest"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"("}),s.jsx(e.span,{style:{color:"#005CC5","--shiki-dark":"#6CB6FF"},children:"uint256"}),s.jsx(e.span,{style:{color:"#E36209","--shiki-dark":"#F69D50"},children:" x"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:") "}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"public"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"    // --- snip ---"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  }"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"}"})})]})})}),`
`,s.jsxs(e.h3,{id:"in-line-fuzz-configs",children:["In-line fuzz configs",s.jsx(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#in-line-fuzz-configs",children:s.jsx(e.div,{"data-autolink-icon":!0})})]}),`
`,s.jsxs(e.p,{children:["Users can specify the configs described in the table. Each statement must have a prefix of the form ",s.jsx(e.code,{children:"forge-config: ${PROFILE}.fuzz."})]}),`
`,s.jsxs(e.table,{children:[s.jsx(e.thead,{children:s.jsxs(e.tr,{children:[s.jsx(e.th,{children:"Parameter"}),s.jsx(e.th,{children:"Type"}),s.jsx(e.th,{children:"Description"})]})}),s.jsxs(e.tbody,{children:[s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"runs"})}),s.jsx(e.td,{children:"integer"}),s.jsxs(e.td,{children:["The amount of fuzz runs to perform for this specific test case. ",s.jsx(e.a,{href:"./testing.md#runs",children:s.jsx(e.code,{children:"Reference"})}),"."]})]}),s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"max-test-rejects"})}),s.jsx(e.td,{children:"integer"}),s.jsxs(e.td,{children:["The maximum number of combined inputs that may be rejected before the test as a whole aborts. ",s.jsx(e.a,{href:"./testing.md#max_test_rejects",children:s.jsx(e.code,{children:"Reference"})}),"."]})]}),s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"show-logs"})}),s.jsx(e.td,{children:"boolean"}),s.jsxs(e.td,{children:["The flag indicates whether to display console logs in fuzz tests or not. Works when ",s.jsx(e.code,{children:"verbosity >= 2"}),". ",s.jsx(e.a,{href:"./testing.md#show_logs",children:s.jsx(e.code,{children:"Reference"})}),"."]})]})]})]}),`
`,s.jsx(e.p,{children:"Fuzz config example"}),`
`,s.jsx(s.Fragment,{children:s.jsx(e.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:s.jsxs(e.code,{children:[s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"contract"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" MyFuzzTest"}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:" is"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" Test"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.fuzz.runs = 100"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.fuzz.max-test-rejects = 2"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.fuzz.show-logs = true"})}),`
`,s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"  function"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#DCBDFB"},children:" test_InlineConfig"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"("}),s.jsx(e.span,{style:{color:"#005CC5","--shiki-dark":"#6CB6FF"},children:"uint256"}),s.jsx(e.span,{style:{color:"#E36209","--shiki-dark":"#F69D50"},children:" x"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:") "}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"public"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"    // --- snip ---"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  }"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"}"})})]})})}),`
`,s.jsxs(e.h3,{id:"in-line-invariant-configs",children:["In-line invariant configs",s.jsx(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#in-line-invariant-configs",children:s.jsx(e.div,{"data-autolink-icon":!0})})]}),`
`,s.jsxs(e.p,{children:["Users can specify the configs described in the table. Each statement must have a prefix of the form ",s.jsx(e.code,{children:"forge-config: ${PROFILE}.invariant."})]}),`
`,s.jsxs(e.table,{children:[s.jsx(e.thead,{children:s.jsxs(e.tr,{children:[s.jsx(e.th,{children:"Parameter"}),s.jsx(e.th,{children:"Type"}),s.jsx(e.th,{children:"Description"})]})}),s.jsxs(e.tbody,{children:[s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"runs"})}),s.jsx(e.td,{children:"integer"}),s.jsxs(e.td,{children:["The amount of invariant runs to perform for this specific test case. ",s.jsx(e.a,{href:"./testing.md#runs-1",children:s.jsx(e.code,{children:"Reference"})}),"."]})]}),s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"depth"})}),s.jsx(e.td,{children:"integer"}),s.jsxs(e.td,{children:["The number of calls executed to attempt to break invariant in one run. ",s.jsx(e.a,{href:"./testing.md#depth",children:s.jsx(e.code,{children:"Reference"})}),"."]})]}),s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"fail-on-revert"})}),s.jsx(e.td,{children:"boolean"}),s.jsxs(e.td,{children:["Fails the invariant fuzzing if a revert occurs. ",s.jsx(e.a,{href:"./testing.md#fail_on_revert",children:s.jsx(e.code,{children:"Reference"})}),"."]})]}),s.jsxs(e.tr,{children:[s.jsx(e.td,{children:s.jsx(e.code,{children:"call-override"})}),s.jsx(e.td,{children:"boolean"}),s.jsxs(e.td,{children:["Overrides unsafe external calls when running invariant test. ",s.jsx(e.a,{href:"./testing.md#call_override",children:s.jsx(e.code,{children:"Reference"})}),"."]})]})]})]}),`
`,s.jsx(e.p,{children:"Invariant config example"}),`
`,s.jsx(s.Fragment,{children:s.jsx(e.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:s.jsxs(e.code,{children:[s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"contract"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" MyInvariantTest"}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:" is"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#F69D50"},children:" Test"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.invariant.runs = 100"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.invariant.depth = 2"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.invariant.fail-on-revert = false"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"  /// forge-config: default.invariant.call-override = true"})}),`
`,s.jsxs(e.span,{className:"line",children:[s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"  function"}),s.jsx(e.span,{style:{color:"#6F42C1","--shiki-dark":"#DCBDFB"},children:" invariant_InlineConfig"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"() "}),s.jsx(e.span,{style:{color:"#D73A49","--shiki-dark":"#F47067"},children:"public"}),s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:" {"})]}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#6A737D","--shiki-dark":"#768390"},children:"    // --- snip ---"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  }"})}),`
`,s.jsx(e.span,{className:"line",children:s.jsx(e.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"}"})})]})})})]})}function d(n={}){const{wrapper:e}={...r(),...n.components};return e?s.jsx(e,{...n,children:s.jsx(i,{...n})}):i(n)}export{d as default,c as frontmatter};
