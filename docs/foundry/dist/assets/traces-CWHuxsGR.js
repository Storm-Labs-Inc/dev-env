import{j as e}from"./index-D5UbER3f.js";import{u as i}from"./index-CZxYc6i7.js";const c={description:"Debug test execution with detailed call traces showing gas usage, contract interactions, and return values."};function n(r){const s={a:"a",code:"code",div:"div",h2:"h2",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...i(),...r.components};return e.jsxs(e.Fragment,{children:[e.jsxs(s.h2,{id:"understanding-traces",children:["Understanding Traces",e.jsx(s.a,{"aria-hidden":"true",tabIndex:"-1",href:"#understanding-traces",children:e.jsx(s.div,{"data-autolink-icon":!0})})]}),`
`,e.jsxs(s.p,{children:["Forge can produce traces either for failing tests (",e.jsx(s.code,{children:"-vvv"}),") or all tests (",e.jsx(s.code,{children:"-vvvv"}),")."]}),`
`,e.jsx(s.p,{children:"Traces follow the same general format:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:e.jsxs(s.code,{children:[e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  [<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Gas"}),e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:" Usage"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">] <"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Contract"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">::<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Function"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">(<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Parameters"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    ├─ [<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Gas"}),e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:" Usage"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">] <"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Contract"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">::<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Function"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">(<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Parameters"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">)"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    │   └─ ← <"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Return"}),e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:" Value"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    └─ ← <"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Return"}),e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:" Value"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">"})]})]})})}),`
`,e.jsx(s.p,{children:"Each trace can have many more subtraces, each denoting a call to a contract and a return value."}),`
`,e.jsx(s.p,{children:"If your terminal supports color, the traces will also come with a variety of colors:"}),`
`,e.jsxs(s.ul,{children:[`
`,e.jsxs(s.li,{children:[e.jsx(s.strong,{children:"Green"}),": For calls that do not revert"]}),`
`,e.jsxs(s.li,{children:[e.jsx(s.strong,{children:"Red"}),": For reverting calls"]}),`
`,e.jsxs(s.li,{children:[e.jsx(s.strong,{children:"Blue"}),": For calls to cheat codes"]}),`
`,e.jsxs(s.li,{children:[e.jsx(s.strong,{children:"Cyan"}),": For emitted logs"]}),`
`,e.jsxs(s.li,{children:[e.jsx(s.strong,{children:"Yellow"}),": For contract deployments"]}),`
`]}),`
`,e.jsx(s.p,{children:"The gas usage (marked in square brackets) is for the entirety of the function call. You may notice, however, that sometimes the gas usage of one trace does not exactly match the gas usage of all its subtraces:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:e.jsxs(s.code,{children:[e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  ["}),e.jsx(s.span,{style:{color:"#032F62",textDecoration:"underline","--shiki-dark":"#96D0FF","--shiki-dark-text-decoration":"inherit"},children:"24661"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"] OwnerUpOnlyTest::testIncrementAsOwner()"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    ├─ ["}),e.jsx(s.span,{style:{color:"#032F62",textDecoration:"underline","--shiki-dark":"#96D0FF","--shiki-dark-text-decoration":"inherit"},children:"2262"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"] OwnerUpOnly::count()"})]}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    │   └─ ← 0"})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    ├─ ["}),e.jsx(s.span,{style:{color:"#032F62",textDecoration:"underline","--shiki-dark":"#96D0FF","--shiki-dark-text-decoration":"inherit"},children:"20398"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"] OwnerUpOnly::increment()"})]}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    │   └─ ← ()"})}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    ├─ ["}),e.jsx(s.span,{style:{color:"#032F62",textDecoration:"underline","--shiki-dark":"#96D0FF","--shiki-dark-text-decoration":"inherit"},children:"262"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"] OwnerUpOnly::count()"})]}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    │   └─ ← 1"})}),`
`,e.jsx(s.span,{className:"line",children:e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    └─ ← ()"})})]})})}),`
`,e.jsx(s.p,{children:"The gas unaccounted for is due to some extra operations happening between calls, such as arithmetic and store reads/writes."}),`
`,e.jsx(s.p,{children:"Forge will try to decode as many signatures and values as possible, but sometimes this is not possible. In these cases, the traces will appear like so:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(s.pre,{className:"shiki shiki-themes github-light github-dark-dimmed",style:{backgroundColor:"#fff","--shiki-dark-bg":"#22272e",color:"#24292e","--shiki-dark":"#adbac7"},tabIndex:"0",children:e.jsxs(s.code,{children:[e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"  [<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Gas"}),e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:" Usage"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">] <"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Address"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">::<"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Calldata"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">"})]}),`
`,e.jsxs(s.span,{className:"line",children:[e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:"    └─ ← <"}),e.jsx(s.span,{style:{color:"#22863A","--shiki-dark":"#8DDB8C"},children:"Return"}),e.jsx(s.span,{style:{color:"#6F42C1","--shiki-dark":"#6CB6FF"},children:" Data"}),e.jsx(s.span,{style:{color:"#24292E","--shiki-dark":"#ADBAC7"},children:">"})]})]})})}),`
`,e.jsx(s.p,{children:"Some traces might be harder to grasp at first glance. These include:"}),`
`,e.jsxs(s.ul,{children:[`
`,e.jsxs(s.li,{children:["The ",e.jsx(s.code,{children:"OOG"}),' shorthand stands for "Out Of Gas".']}),`
`,e.jsxs(s.li,{children:["The acronym ",e.jsx(s.code,{children:"EOF"}),' stands for "Ethereum Object Format", which introduces an extensible and versioned container format for EVM bytecode. For more information, read ',e.jsx(s.a,{href:"https://evmobjectformat.org/",children:"here"}),"."]}),`
`,e.jsxs(s.li,{children:[e.jsx(s.code,{children:"NotActivated"})," means the feature or opcode is not activated. Some versions of the EVM only support certain opcodes. You may need to use a more recent version using the ",e.jsx(s.code,{children:"--evm_version"})," flag. For example, the ",e.jsx(s.code,{children:"PUSH0"})," opcode is only available since the ",e.jsx(s.a,{href:"https://www.evm.codes/?fork=shanghai",children:"Shanghai"})," hardfork."]}),`
`,e.jsxs(s.li,{children:[e.jsx(s.code,{children:"InvalidFEOpcode"})," means that an undefined bytecode value has been encountered during execution. The EVM catches the unknown bytecode and returns the ",e.jsx(s.code,{children:"INVALID"})," opcode instead, of value ",e.jsx(s.code,{children:"0xFE"}),". You can find out more ",e.jsx(s.a,{href:"https://www.evm.codes/#fe",children:"here"}),"."]}),`
`]}),`
`,e.jsxs(s.p,{children:["For a deeper insight into the various traces, you can explore the ",e.jsx(s.a,{href:"https://github.com/bluealloy/revm/blob/main/crates/interpreter/src/instruction_result.rs",children:"revm source code"}),"."]})]})}function o(r={}){const{wrapper:s}={...i(),...r.components};return s?e.jsx(s,{...r,children:e.jsx(n,{...r})}):n(r)}export{o as default,c as frontmatter};
